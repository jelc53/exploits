<h3>Transfer Bitbars</h3>


<form class="pure-form pure-form-stacked" action="post_transfer" method="post">
  <!-- BRAVO defense: added hidden input fields for csrf and hmac -->
  <input type="hidden" id="csrf" name="csrfToken" value="placeholder">
  <input type="hidden" id="hmac" name="HMACSig" value="placeholder">

  <script>
    // src="../../../utils/crypto"
    // import generateRandomness from crypto

    // BRAVO defense: set csrf token and sign it using HMAC
    // except JS doesn't have access to DOM here. so include this
    // in <script> tag in actual form.ejs file?
    // let csrfInputField = document.getElementById("csrf");
    // let currCsrfToken = generateRandomness();
    // csrfInputField.value = currCsrfToken;

    // let hmacInputField = document.getElementById("hmac");
    // currSigKey = generateRandomness(); // hex-encoded string
    // hmacInputField.value = HMAC(currSigKey, csrfToken.value);
  </script>


  <% if(errorMsg) { %>
    <p class='error'> <%- errorMsg %> </p>
  <% } %>

	<p>
		You currently have <%= account.bitbars %> bitbars.
	</p>

  <label for="destination_username">Transfer to</label>
  <input type="text" name="destination_username" value="<%= result.receiver %>">

  <label for="quantity">Amount</label>
  <input type="text" name="quantity" value="<%= result.amount %>"/>

  <p><input type="submit" class="pure-button button-primary" value="Transfer" /></p>
</form>
