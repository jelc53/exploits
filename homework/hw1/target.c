#include <stdio.h>
#include <stdlib.h>

struct widget { char str[128]; int *ptr; };

void func(char *input) {
    widget blah;
    blah.ptr = 0x00;  // overwritten by attacker
    strcpy(blah.str, input)  // overflow str buffer
    // str = malicious code, ptr = return address
    (*blah->ptr) = blah.str;  // overwrite return address
}

int main(int argc, char**argv) {
    func(argv[1]);
    return 0;
}
